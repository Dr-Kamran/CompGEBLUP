% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/13_workflows.R
\name{build_mixed_kernel}
\alias{build_mixed_kernel}
\title{Build Trace-Scaled Mixed Kernel}
\usage{
build_mixed_kernel(K_list, varcomp = NULL, ridge = 0.01, verbose = TRUE)
}
\arguments{
\item{K_list}{Named list of relationship matrices to combine.}

\item{varcomp}{Named numeric vector of variance components (names matching K_list).
If NULL, equal weights are used.}

\item{ridge}{Ridge to add to the combined matrix (default: 0.01).}

\item{verbose}{Print diagnostics (default TRUE).}
}
\value{
A single combined relationship matrix.
}
\description{
Combines two or more relationship matrices using variance-component-weighted,
trace-normalised combination. This ensures matrices on different scales
contribute proportionally to the combined genetic covariance.
}
\details{
The weight for matrix K_i is: \code{w_i = sigma2_i * tr(K_i) / sum(sigma2_j * tr(K_j))}
}
\examples{
\dontrun{
K_comb <- build_mixed_kernel(list(A = A, AA = AA),
                              varcomp = c(A = sig2_A, AA = sig2_AA))
}
}
