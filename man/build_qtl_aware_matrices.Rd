% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/11_qtl_aware_gblup.R
\name{build_qtl_aware_matrices}
\alias{build_qtl_aware_matrices}
\title{Build QTL-Aware Matrices}
\usage{
build_qtl_aware_matrices(
  M,
  qtl_markers = NULL,
  qtl_env_markers = NULL,
  env_names = NULL,
  method = c("VanRaden", "UAR"),
  min.MAF = 0.01
)
}
\arguments{
\item{M}{Marker matrix (individuals x markers) coded as -1, 0, 1}

\item{qtl_markers}{Character vector of QTL marker names to treat as fixed effects}

\item{qtl_env_markers}{Optional list of environment-specific QTL markers}

\item{env_names}{Optional character vector of environment names}

\item{method}{Method for A matrix ("VanRaden", "UAR")}

\item{min.MAF}{Minimum MAF for filtering non-QTL markers}
}
\value{
List containing:
\item{Ka}{Reduced additive matrix (excludes QTL markers)}
\item{Xa}{QTL marker genotypes for fixed effects}
\item{A_full}{Full additive matrix (all markers)}
\item{qtl_idx}{Indices of QTL markers}
\item{non_qtl_idx}{Indices of non-QTL markers}
}
\description{
Constructs relationship matrices that exclude specified QTL markers,
and extracts QTL genotypes for use as fixed effects.
}
\examples{
\dontrun{
# After GWAS, get significant markers
sig_markers <- get_significant_markers(gwas_res)$marker

# Build QTL-aware matrices
qtl_mats <- build_qtl_aware_matrices(M, qtl_markers = sig_markers)

# Fit model with QTLs as fixed effects
model <- fit_gblup_qtl(gdata, Ka = qtl_mats$Ka, Xa = qtl_mats$Xa)
}
}
