% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/13_workflows.R
\name{build_reaction_norm_kernel}
\alias{build_reaction_norm_kernel}
\title{Build Finlay-Wilkinson Reaction Norm Kernel}
\usage{
build_reaction_norm_kernel(gdata, A, min_env = 3, verbose = TRUE)
}
\arguments{
\item{gdata}{GBLUPData object with phenotypes containing GID, ENV, trait.}

\item{A}{Additive relationship matrix (used as base for kernel scaling).}

\item{min_env}{Minimum environments per genotype for slope estimation (default: 3).
Genotypes with fewer environments receive a slope of 0 (average sensitivity).}

\item{verbose}{Print diagnostics (default TRUE).}
}
\value{
A reaction norm kernel matrix (n_gid x n_gid).
}
\description{
Constructs a reaction norm kernel from genotype-specific environmental
sensitivity (slope). The kernel captures GxE arising from heterogeneous
responses to environmental quality: \code{K_rn[i,j] = b_i * b_j * A[i,j]}
where \code{b_i} is genotype i's centred FW regression slope.
}
\examples{
\dontrun{
K_rn <- build_reaction_norm_kernel(gdata, A)
model_rn <- fit_gblup(gdata, K_matrices = list(A = A, RN = K_rn),
                       effects = c("A", "ENV", "RN"), fixed = ~ TESTER)
}
}
\references{
Finlay, K.W. and Wilkinson, G.N. (1963) The analysis of
adaptation in a plant-breeding programme. \emph{Australian Journal of
Agricultural Research}, 14, 742--754.
}
