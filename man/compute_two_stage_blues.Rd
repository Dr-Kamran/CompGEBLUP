% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/13_workflows.R
\name{compute_two_stage_blues}
\alias{compute_two_stage_blues}
\title{Compute Two-Stage BLUEs}
\usage{
compute_two_stage_blues(gdata, fixed = NULL, verbose = TRUE)
}
\arguments{
\item{gdata}{GBLUPData object with raw observations. Phenotypes must contain
GID, ENV, and trait columns.}

\item{fixed}{Stage-1 confounders to absorb. A one-sided formula referencing
columns in \code{gdata@phenotypes} (e.g. \code{~ TESTER}, \code{~ TESTER + BLOCK}).
Default is NULL (no confounders, BLUEs = GID means per ENV).}

\item{verbose}{Print diagnostics (default TRUE).}
}
\value{
A new GBLUPData object where \code{trait} contains per-GID x ENV BLUEs.
Original genotypes and MAF are preserved.
}
\description{
Performs Stage-1 within-environment analysis to extract tester-adjusted BLUEs
(Best Linear Unbiased Estimates), then creates a new GBLUPData object for
Stage-2 genomic prediction. This absorbs confounding effects (tester, block,
replication) that would otherwise bias GxE variance components.
}
\details{
Stage 1 fits \code{trait ~ GID + confounders} within each environment using OLS,
then extracts per-GID marginal means. Stage 2 uses these BLUEs as the response
in genomic prediction models.
}
\examples{
\dontrun{
gdata_2stage <- compute_two_stage_blues(gdata, fixed = ~ TESTER)
model_3 <- fit_model3_AE(gdata_2stage)
}
}
