% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/06_multi_trait.R
\name{fit_multi_trait}
\alias{fit_multi_trait}
\title{Fit Multi-Trait GBLUP Model}
\usage{
fit_multi_trait(
  gblup_data,
  traits,
  K_matrices,
  effects = c("A", "ENV"),
  genetic_model = c("diagonal", "unstructured"),
  ridge = 0.001,
  nIters = 50,
  tolParConvLL = 1e-04,
  verbose = FALSE
)
}
\arguments{
\item{gblup_data}{GBLUPData object}

\item{traits}{Character vector of trait names (columns in phenotype data)}

\item{K_matrices}{List of relationship matrices}

\item{effects}{Character vector of effects to include}

\item{genetic_model}{Type of genetic covariance: "diagonal" (default), "unstructured"}

\item{ridge}{Ridge parameter}

\item{nIters}{Maximum iterations for REML}

\item{tolParConvLL}{Convergence tolerance}

\item{verbose}{Print fitting details}
}
\value{
List containing:
\item{models}{List of single-trait GBLUPModel objects}
\item{genetic_correlations}{Matrix of genetic correlations between traits}
\item{residual_correlations}{Matrix of residual correlations between traits}
\item{gebvs}{Data frame with GEBVs for all traits}
\item{varcomp}{Variance components per trait}
}
\description{
Fits a multi-trait genomic prediction model using simplified multivariate REML.
This is a basic implementation suitable for correlated trait analysis.
}
\details{
This function fits independent GBLUP models per trait and estimates genetic/residual
correlations. For full multivariate REML with proper covariance estimation,
consider specialized packages like sommer or MTM.
}
\note{
Returns a list rather than S4 object. Access genetic correlations via
\code{result$genetic_correlations} and GEBVs via \code{result$gebvs}.
}
\seealso{
\code{\link{fit_gblup}} for single-trait models
}
