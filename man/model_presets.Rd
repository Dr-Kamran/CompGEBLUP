% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/13_workflows.R, R/model_presets.R
\name{fit_model3R_reaction_norm}
\alias{fit_model3R_reaction_norm}
\alias{fit_model5C_mixed_kernel}
\alias{model_presets}
\alias{fit_model1_A}
\alias{fit_model2_AD}
\alias{fit_model3_AE}
\alias{fit_model4_ADE}
\alias{fit_model5_ADAA}
\title{Fit Pre-defined GBLUP Models}
\usage{
fit_model3R_reaction_norm(
  gdata,
  A = NULL,
  ridge = 0.001,
  ridge_RN = 0.05,
  nIters = 500,
  verbose = TRUE,
  fixed = NULL
)

fit_model5C_mixed_kernel(
  gdata,
  A = NULL,
  AA = NULL,
  varcomp = NULL,
  ridge = 0.001,
  ridge_AE = 0.05,
  nIters = 500,
  verbose = TRUE,
  fixed = NULL
)

fit_model1_A(gdata, ridge = 0.001, nIters = 500, verbose = TRUE, fixed = NULL)

fit_model2_AD(
  gdata,
  ridge = 0.001,
  ridge_D = 0.05,
  nIters = 500,
  verbose = TRUE,
  fixed = NULL
)

fit_model3_AE(
  gdata,
  ridge = 0.001,
  ridge_AE = 0.05,
  nIters = 500,
  verbose = TRUE,
  fixed = NULL
)

fit_model4_ADE(
  gdata,
  include_DE = FALSE,
  ridge = 0.001,
  ridge_D = 0.05,
  ridge_AE = 0.05,
  nIters = 500,
  verbose = TRUE,
  fixed = NULL
)

fit_model5_ADAA(
  gdata,
  include_D = FALSE,
  include_AAE = FALSE,
  ridge = 0.001,
  ridge_D = 0.05,
  ridge_AA = 0.05,
  ridge_AE = 0.05,
  nIters = 500,
  verbose = TRUE,
  fixed = NULL
)
}
\arguments{
\item{gdata}{GBLUPData object}

\item{ridge}{Base ridge parameter (default: 0.001). Used for well-conditioned matrices.}

\item{nIters}{Maximum REML iterations (default: 500). Increase for complex models.}

\item{verbose}{Logical, print progress messages}

\item{fixed}{Optional fixed effects specification (e.g., ~ TESTER). Default is NULL.}

\item{ridge_AE}{Ridge for GxE Kronecker matrix (default: 0.05). AE is high-dimensional.}

\item{ridge_D}{Ridge for dominance matrix (default: 0.05). D has many near-zero eigenvalues.}

\item{include_DE}{Logical, include dominance-by-environment interaction in Model 4
(default: FALSE). DE typically causes overfitting in hybrid breeding data.}

\item{include_D}{Logical, include dominance in Model 5 (default: FALSE).
σ²_D is often a boundary estimate when epistasis is already in the model.}

\item{include_AAE}{Logical, include epistasis-by-environment in Model 5 (default: FALSE).}

\item{ridge_AA}{Ridge for epistasis matrix (default: 0.05). AA Hadamard is ill-conditioned.}

\item{use.emma}{Solver selection (default: FALSE for multi-effect, TRUE for M1).}
}
\value{
GBLUPModel object
}
\description{
Convenience functions to fit the 5 core GBLUP models.
Updated in v2.3.1 to reflect empirically validated model structures
from G2F 2021 analysis:
\itemize{
\item Model 4 drops DE by default (DE causes severe overfitting in hybrid data)
\item Model 5 drops D by default (σ²_D often hits boundary in multi-effect models)
\item All presets use \code{ridge_per_matrix} for differential regularisation
\item Default \code{nIters = 500} (50 is too few for multi-effect convergence)
}
}
\examples{
\dontrun{
gdata <- simulate_genotypes(n_ind = 100, n_snp = 500)
gdata <- simulate_phenotypes(gdata, n_env = 3, h2 = 0.6, n_qtl = 20)

# Fit each of the 5 core models
m1 <- fit_model1_A(gdata)
m2 <- fit_model2_AD(gdata)
m3 <- fit_model3_AE(gdata)
m4 <- fit_model4_ADE(gdata)               # No DE by default
m4_de <- fit_model4_ADE(gdata, include_DE = TRUE)  # With DE
m5 <- fit_model5_ADAA(gdata)              # No D by default

# Compare models
compare_models(list(M1 = m1, M2 = m2, M3 = m3, M4 = m4, M5 = m5))
}
}
